## 보안점검

### 검사 함수

외부에 나타나는 함수의 이름은 `check_<KISA분석평가 항목코드>`의 형태로 작성하는것을 권장합니다

- ex. `check_pc01()`

함수의 입력은 없습니다. 아무 인자없이 호출합니다

함수의 출력은 정보가 담긴 `queue.Queue`를 리턴합니다

`queue.Queue` 내 담긴 정보의 포맷은 아래와 같습니다

### 정보 포맷

```python
{
    "id" : "",
    "sub-id" : "",
    "type" : "",
    "reason" : ""
}
```

딕셔너리의 형태이며 각각의 필드는 모두 문자열입니다

- `id` : KISA 분석평가의 항목코드를 나타냅니다
    - ex. "1.계정 관리 : 패스워드의 주기적 변경" 의 경우 id는 `PC-01`
- `sud-id` : 각 항목 내에서 정확히 부분에 대한 것인지를 나타냅니다 `<id>-<분류문자>`의 형태이며 분류문자는 대문자알파벳과 `-`으로만 이루어집니다
    - ex. `PC-01`의 패스워드 최대사용기간에 문제가 생겼다면 해당 정보에 대한 sub-id는 `PC-01-MAXPWAGE`
    - `sub-id`는 취약점 해결 및 링크를 걸기 위해 사용합니다
- `type` : 정보가 무엇을 나타내는지를 나타냅니다 `error`, `warning`, `info` 중 하나가 들어갑니다
    - `error` : 취약점 검사결과 문제가 있다는 것을 나타냅니다
    - `warning` : 검사를 할 수 없거나(권한 문제 등) 취약점이 위험한 수준이 아니지만 경고가 필요한 경우를 나타냅니다
    - `info` : 추가 정보를 나타냅니다
- `reason` : 어떤 문제가 발생했는지 메세지를 나타냅니다
    - ex. `PC-01`의 패스워드 최대사용기간에 문제가 생겼다면 reason은 "패스워드 최대사용기간이 XX일을 초과합니다"



## 검사 조치 또는 하이퍼링크 함수

취약점 검사 결과에 대한 정보를 인자로 넣어 링크를 열거나, 취약점을 조치하는 함수를 리턴합니다

함수의 입력은 위 `정보 포맷`을 받습니다
- 딕셔너리 내 `id`와 `sub-id`를 이용해 어떤 함수를 리턴할지 결정합니다

함수의 출력은 아래의 `조치 포맷`을 참조하세요

모든 `sub-id`에 대해 각각 조치 방법쓰는 대신 카테고리 하나당 하나의 조치만 한번에 수행해도 됩니다
- 예를 들어 `PC-01`의 "암호사용기한" 과 "암호길이" 조치사항에 대해서 조치사항을 수행하는 각각의 함수를 따로 리턴해도 되고, `PC-01` 전체 조치사항을 수행하는 함수를 리턴해도 됩니다

같은 함수는 한번만 실행하기 때문에, 동일한 함수를 여러번 리턴하는 문제에 대해 생각하지 않아도 됩니

### 조치 포맷

```python
{
    "type" : "", # 문자열
    "func" : func, # 함수
    "addition" : {}, # 딕셔너리
}
```

`type` : 함수가 어떤 행동을 하는지 나타냅니다. "solve" 또는 "link"를 리턴합니다
- "solve" : 취약점을 조치하는 함수를 리턴합니다
- "link" : 취약점을 사용자가 직접 조치할 수 있도록 조치에 관리 창 또는 웹사이트를 엽니다

`func` : 조치를 수행하는 함수입니다. 직접 조치하거나 또는 조치를 위한 창을 엽니다

`addition` : 추가 정보를 의미합니다
- 사용자가 직접 조치를 수행해야하는 경우 창을 여는 것 뿐 아니라 추가 설명이 필요할 수 있습니다

### 예시

아래는 함수 예시입니다

```python
def solve_pc01_A(): # PC01에 대해 
    pass # ...

def get_solve(info):
    if info["sub-id"] == "PC01-ABC":
        return "solve", solve_pc01
    pass # ...
```

## 임시 파일

탐색중 파일을 임시로 저장할 일이 있다면 "./tmp" 디렉토리내에 저장합니다

"./tmp" 디렉토리는 미리 생성되지 않았을 수 있습니다 

그리고 파일 사용이 끝나면 해당 임시파일은 삭제하는걸 권장합니다